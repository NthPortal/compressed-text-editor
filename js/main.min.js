var settingsModal=$("#settings-modal");var linkShortenerSetting=$("#settings-link-shortener");var linkShortenerKey="paste-setting-link-shortener";var defaultLinkShortener=null;var linkShortener=defaultLinkShortener;var helpModal=$("#help-modal");var storeTextToURLTimeout;var deflateOpts={to:"string"};function saveText(){var a=new Blob([editor.getValue()],{type:"text/plain;charset=utf-8"});saveAs(a,"untitled.txt");editor.focus()}function showHelp(){helpModal[0].style.display="block"}function hideHelp(){helpModal[0].style.display="none";editor.focus()}function loadSettings(){var a=window.localStorage.getItem(linkShortenerKey);if(a===null){a=defaultLinkShortener}linkShortener=a;linkShortenerSetting.val(linkShortener)}function saveSettings(){linkShortener=linkShortenerSetting.val().trim();window.localStorage.setItem(linkShortenerKey,linkShortener);hideSettings()}function showSettings(){settingsModal[0].style.display="block"}function hideSettings(){settingsModal[0].style.display="none";loadSettings();editor.focus()}function doUndo(){editor.undo();editor.focus()}function doRedo(){editor.redo();editor.focus()}function clearText(){if(editor.getValue()!==""){editor.setValue("")}else{editor.clearHistory();var a=window.location.hash;if(a!==""){window.location.hash=""}}editor.focus()}function encodeBase64(a){return btoa(a).replace(/[+\/=]/g,function(b){switch(b){case"+":return"-";case"/":return"_";case"=":return"~"}})}function decodeBase64(a){return atob(a.replace(/[-_~]/g,function(b){switch(b){case"-":return"+";case"_":return"/";case"~":return"="}}))}function loadTextFromURL(){var b=window.location.hash;if(b!==""&&b!=="#"){var a=null;var d=setTimeout(function(){a=toastr.info("Loading text...")},5);try{editor.setValue(pako.inflateRaw(decodeBase64(b.slice(1)),deflateOpts))}catch(c){console.error(c);toastr.error("See console for details","Error loading text")}clearTimeout(d);if(a!==null){toastr.clear(a)}}}function storeTextToURL(){var b=editor.getValue();if(b!==""){var a=pako.deflateRaw(editor.getValue(),deflateOpts);window.location.hash=encodeBase64(a)}else{window.location.hash=""}}function maybeOpenLinkShortener(){if(linkShortener!==null&&linkShortener!==""){window.open(linkShortener,"_blank")}}function copyLink(){storeTextToURL();if(document.queryCommandSupported("copy")){var a=document.createElement("textarea");a.style.position="fixed";a.style.zIndex=-1;a.value=window.location.href;document.body.appendChild(a);a.select();document.execCommand("copy");document.body.removeChild(a);toastr.success("Copied link to clipboard");setTimeout(maybeOpenLinkShortener,1000)}else{if(prompt('Copy the URL, then click "OK".',window.location.href)){maybeOpenLinkShortener()}}editor.focus()}function updateURL(){clearTimeout(storeTextToURLTimeout);storeTextToURLTimeout=setTimeout(storeTextToURL,1000)}function toggleLightDarkStyle(){if(getLightDarkStyle()===styleLight){setStyleDark()}else{setStyleLight()}editor.focus()}$("#copy-link").click(copyLink);$("#toggle-light-dark").click(toggleLightDarkStyle);$("#undo").click(doUndo);$("#redo").click(doRedo);$("#clear-text").click(clearText);$("#settings").click(showSettings);$("#settings-modal-close").click(hideSettings);$("#settings-save").click(saveSettings);$("#help").click(showHelp);$("#help-modal-close").click(hideHelp);editor.on("change",updateURL);document.addEventListener("keydown",function(a){if((a.keyCode===115||a.keyCode===83)&&(a.ctrlKey||a.metaKey)){saveText();a.preventDefault();return false}else{return true}});document.addEventListener("drop",function(b){b.preventDefault();b.stopPropagation();var a=new FileReader();a.onload=function(){editor.setValue(a.result)};a.readAsText(b.dataTransfer.files[0])});window.onclick=function(a){if(a.target===helpModal[0]){hideHelp()}else{if(a.target===settingsModal[0]){hideSettings()}}};toastr.options={closeButton:false,debug:false,newestOnTop:false,progressBar:false,positionClass:"toast-top-right",preventDuplicates:false,onclick:null,showDuration:"300",hideDuration:"300",timeOut:"5000",extendedTimeOut:"5000",showEasing:"linear",hideEasing:"linear",showMethod:"slideDown",hideMethod:"slideUp"};loadSettings();loadTextFromURL();